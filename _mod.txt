Attribute VB_Name = "Module7"

Sub AddNetBalanceNextToPrinciple()
    Dim ws As Worksheet, wsT As Worksheet
    Dim lastRow As Long, lasTrowT As Long
    Dim colPrinciple As Integer
    Dim colNext As Long
    Dim i As Long

    ' Set the worksheet (change "Sheet1" to your specific sheet name if needed)
    Set ws = ThisWorkbook.Worksheets("Pursuit-CDC")
    Set wsT = ThisWorkbook.Worksheets("Non-Accrual - $0")
    
    ' Find the column for "Principal"
    colPrinciple = FindHeaderCol2(ws, "Principal")
    
    Debug.Print "Principal column: " & colPrinciple
    ' If the "Principal" column is not found, exit the subroutine
    If colPrinciple = 0 Then
        MsgBox "Principal column not found!"
        Exit Sub
    End If

    ' Get the last row in the sheet
    lastRow = ws.Cells(ws.Rows.Count, colPrinciple).End(xlUp).row

    ' Loop through all rows in the "Principal" column
    For i = 2 To lastRow ' Assuming headers are in the first row
        If ws.Cells(i, colPrinciple).Value = "Principal" Then
            colNext = colPrinciple + 1
            If ws.Cells(i, colNext).Value <> "Net Balance" Then
                ws.Cells(i, colNext).Value = "Net Balance"
                ws.Cells(i, colNext).Font.Bold = True
            End If
        End If
    Next i

    ' do the same for wsT
    colPrinciple = FindHeaderCol2(wsT, "Principal")
    
    If colPrinciple = 0 Then
        MsgBox "Principal columnn not found"
        Exit Sub
    End If
    
    lasTrowT = wsT.Cells(wsT.Rows.Count, colPrinciple).End(xlUp).row
    
    'looping through all rows in Principal col
      For i = 2 To lasTrowT ' Assuming headers are in the first row
        If wsT.Cells(i, colPrinciple).Value = "Principal" Then
            colNext = colPrinciple + 1
            If wsT.Cells(i, colNext).Value <> "Net Balance" Then
                wsT.Cells(i, colNext).Value = "Net Balance"
                wsT.Cells(i, colNext).Font.Bold = True
            End If
        End If
    Next i
     
  '  MsgBox "'Net Balance' has been added next to 'Principal' where necessary!"
End Sub

Function FindHeaderCol2(ws As Worksheet, header As String) As Long
    Dim rng As Range
    Set rng = ws.Rows(2).Find(What:=header, LookIn:=xlValues, LookAt:=xlWhole, MatchCase:=False)
    If Not rng Is Nothing Then
        FindHeaderCol2 = rng.Column
    Else
        FindHeaderCol2 = 0 ' Return 0 if the header is not found
    End If
End Function

Sub ClearSBAGtyIfRowEmpty()
    Dim ws As Worksheet
    Dim lastRow As Long
    Dim lastCol As Long
    Dim colSBAGty As Long
    Dim i As Long
    Dim j As Long
    Dim isEmptyRow As Boolean

    ' Set the worksheet (change "Sheet1" to your specific sheet name if needed)
    Set ws = ThisWorkbook.Worksheets("Pursuit-CDC")

    ' Find the column for "SBA Gty%"
    colSBAGty = FindHeaderCol2(ws, "SBA Gty%")

    ' If the "SBA Gty%" column is not found, exit the subroutine
    If colSBAGty = 0 Then
        MsgBox "SBA Gty% column not found!"
        Exit Sub
    End If

    ' Get the last row and last column in the sheet
    lastRow = ws.Cells(ws.Rows.Count, colSBAGty).End(xlUp).row
    lastCol = ws.Cells(2, ws.Columns.Count).End(xlToLeft).Column

    ' Loop through all rows in the "SBA Gty%" column
    For i = 2 To lastRow ' Assuming headers are in the first row
        isEmptyRow = True
        For j = 1 To lastCol
            If j <> colSBAGty And ws.Cells(i, j).Value <> "" Then
                isEmptyRow = False
                Exit For
            End If
        Next j
        ' Clear "SBA Gty%" cell if the rest of the row is empty
        If isEmptyRow Then
            ws.Cells(i, colSBAGty).ClearContents
        End If
    Next i

  '  MsgBox "'SBA Gty%' contents cleared for empty rows!"
End Sub


Sub RemoveZeroPercentRows()
    Dim ws As Worksheet
    Dim lastRow As Long
    Dim i As Long
    Dim colSBAGty As Integer
    
    ' This macro removes leading zeroes by looking at the Net Balance and if there isnt a loan Nbr then the row is cleared
    ' Still need to fix the bottom maybe delete all rows after the last loan under the Non-Accrual section
    ' Set the worksheet
    Set ws = ThisWorkbook.Worksheets("Pursuit-CDC")
    
    
     colSBAGty = FindHeaderCol2(ws, "Net Balance")
     Debug.Print "SBA GTY% col: " & colSBAGty
    
    ' Get the last row in the worksheet
    lastRow = ws.Cells(ws.Rows.Count, "A").End(xlUp).row
    
    ' Loop through each row from the bottom to the top
    For i = lastRow To 1 Step -1
        ' Check if column J contains "0%" and column A is empty
        If ws.Cells(i, colSBAGty).Value = "0%" And IsEmpty(ws.Cells(i, "C").Value) Then
            ws.Rows(i).ClearContents
        End If
    Next i

   ' MsgBox "Rows with '0%' in column J and empty column A have been deleted successfully!"
End Sub

